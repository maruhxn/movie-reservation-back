# 영화 에매 서비스 (backend)

v1.0.0
2023-07-04

## STACK

- CLIENT: Next.js
- SERVER: Nest.js
- DB: PostgreSQL
- Cache: Redis
- cloud storage: amazon s3 or cloudinary
- Auth: Passport - Local, Kakao
- Deploy: Vercel(client) + AWS EC2 or AWS Lightsail or AWS Lambda(server) + AWS RDS + upstash +
- CI/CD: Github Actions + Docker

## 유저 기능

- 로그인 / 회원가입 기능 - Email 로그인, Kakao 로그인
- 유저는 현재 상영 중인 영화 정보를 확인할 수 있다.
- 유저는 로그인 후 '예매하기 -> 영화선택 -> (영화 스케쥴을 보여줌) 영화관 선택 -> 날짜 선택 -> 시간 선택 -> 선택 + 좌석 선택 -> 결제하기'의 흐름을 따라 영화 예매가 가능하다.
- 영화스케쥴은 영화, 상영 시간, 상영관으로 이루어져 있다.
- 유저는 영화 스케쥴에 대한 예매를 진행한다.
- 쿠폰이 존재하고 기간이 유효하다면 쿠폰을 통해 할인을 받을 수 있다.
- 쿠폰을 어떻게 받을까? (일단은 특정 영화의 예매 건수가 10회가 넘어가면 메인 페이지에 쿠폰 10장을 뿌리는 방식을 구현해보자.)
- "매주 월, 수, 금 00시 00분"에 open API로부터 현재 상영 중인 영화 정보 및 세부 정보를 받아오고, 이를 DB에 저장 및 업데이트한다.

## 관리자 기능

- 관리자 계정을 통해 로그인 하여 관리자 페이지에 접근할 수 있다.
- 관리자는 상영 중인 영화를 원할 때마다 불러올 수 있다. (open api의 한계 limit도 고려할 필요) -> 불러온 데이터를 통해 DB에 저장 및 업데이트 하여 영화를 관리한다.
- 영화 스케쥴을 관리할 수 있다. (영화, 상영시간, 상영관을 선택하여 추가 + 수정 + 삭제)
- 상영관을 추가 및 삭제할 수 있다. -> 상영관마다 좌석 수를 다르게 배정할 필요
- 예매된 표를 정렬 기준에 따라 확인 및 관리할 수 있다.
- 관리자의 권한으로 예매표를 추가, 수정, 삭제할 경우 -> 예매한 유저의 이메일 혹은 전화번호를 통해 푸시알림이 간다.
- 쿠폰을 관리할 수 있다. (쿠폰 이름, 할인율, 할인 기간 등)

### 상영 종료 기준

- 개봉일로부터 한달이 지났으면 out-dated로 상영 종료.
